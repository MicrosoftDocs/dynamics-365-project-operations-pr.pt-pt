---
title: Faturação do Project Service Automation
description: Este tópico fornece informações sobre a faturação.
author: rumant
manager: kfend
ms.service: business-applications
ms.custom:
- dyn365-projectservice
ms.date: 03/11/2019
ms.topic: article
ms.prod: ''
ms.technology: Microsoft Dynamics 365  Project Service Automation 2.x and 3.x
audience: Admin
search.audienceType:
- admin
- customizer
- enduser
search.app:
- D365PS
ms.openlocfilehash: 8d95f17aba0a4cab65a6f020aade5e19568de3be
ms.sourcegitcommit: 8c786230ef2a497280885b827162561776e2eb00
ms.translationtype: HT
ms.contentlocale: pt-PT
ms.lasthandoff: 03/24/2020
ms.locfileid: "3754460"
---
# <a name="invoicing-in-project-service-automation"></a><span data-ttu-id="ec110-103">Faturação do Project Service Automation</span><span class="sxs-lookup"><span data-stu-id="ec110-103">Invoicing in Project Service Automation</span></span>

[!INCLUDE[cc-applies-to-psa-app-3.x](../includes/cc-applies-to-psa-app-3x.md)]

<span data-ttu-id="ec110-104">A faturação do Dynamics 365 Project Service Automation é útil porque fornece aos gestores de projeto um segundo nível de aprovação antes de criarem faturas para os clientes.</span><span class="sxs-lookup"><span data-stu-id="ec110-104">Invoicing in Dynamics 365 Project Service Automation is useful because it gives project managers a second level of approval before they create invoices for customers.</span></span> <span data-ttu-id="ec110-105">O primeiro nível de aprovação é concluído quando as entradas de tempo e de despesa que os membros da equipa do projeto submetem são aprovadas.</span><span class="sxs-lookup"><span data-stu-id="ec110-105">The first level of approval is completed when the time and expense entries that project team members submit are approved.</span></span>

<span data-ttu-id="ec110-106">O PSA não foi concebido para gerar faturas direcionadas para o cliente, pelas seguintes razões:</span><span class="sxs-lookup"><span data-stu-id="ec110-106">PSA isn't designed to generate customer-facing invoices, for the following reasons:</span></span>

- <span data-ttu-id="ec110-107">Não contém informações sobre impostos.</span><span class="sxs-lookup"><span data-stu-id="ec110-107">It doesn't contain tax information.</span></span>
- <span data-ttu-id="ec110-108">Não consegue converter outras moedas na moeda de faturação utilizando as taxas de câmbio configuradas corretamente.</span><span class="sxs-lookup"><span data-stu-id="ec110-108">It can't convert other currencies to the invoicing currency by using correctly configured exchange rates.</span></span>
- <span data-ttu-id="ec110-109">Não é possível formatar corretamente as faturas para que possam ser impressas.</span><span class="sxs-lookup"><span data-stu-id="ec110-109">It can't correctly format invoices so that they can be printed.</span></span>

<span data-ttu-id="ec110-110">Em vez disso, pode utilizar um sistema financeiro ou de contabilidade para criar faturas direcionadas para o cliente que utilizem as informações das propostas de fatura geradas no PSA.</span><span class="sxs-lookup"><span data-stu-id="ec110-110">Instead, you can use a financial or accounting system to create customer-facing invoices that use the information from invoice proposals that are generated in PSA.</span></span>

## <a name="creating-project-invoices-in-psa"></a><span data-ttu-id="ec110-111">Criar faturas do projeto no PSA</span><span class="sxs-lookup"><span data-stu-id="ec110-111">Creating project invoices in PSA</span></span>

<span data-ttu-id="ec110-112">É possível criar uma fatura do projeto de cada vez ou em massa.</span><span class="sxs-lookup"><span data-stu-id="ec110-112">Project invoices can be created one at a time or in bulk.</span></span> <span data-ttu-id="ec110-113">Pode criá-las manualmente ou podem ser configuradas para que sejam geradas em execuções automatizadas.</span><span class="sxs-lookup"><span data-stu-id="ec110-113">You can create them manually, or they can be configured so that they are generated in automated runs.</span></span>

### <a name="manually-create-project-invoices-in-psa"></a><span data-ttu-id="ec110-114">Criar manualmente faturas do projeto no PSA</span><span class="sxs-lookup"><span data-stu-id="ec110-114">Manually create project invoices in PSA</span></span>

<span data-ttu-id="ec110-115">A partir da página da lista de **Contratos do Projeto**, pode criar faturas do projeto separadamente para cada contrato do projeto ou pode criar faturas em massa para vários contratos do projeto.</span><span class="sxs-lookup"><span data-stu-id="ec110-115">From the **Project Contracts** list page, you can create project invoices separately for each project contract, or you can create invoices in bulk for multiple project contracts.</span></span>

<span data-ttu-id="ec110-116">Siga este passo para criar uma fatura para um contrato do projeto específico.</span><span class="sxs-lookup"><span data-stu-id="ec110-116">Follow this step to create an invoice for a specific project contract.</span></span>

- <span data-ttu-id="ec110-117">Na página da lista de **Contratos do Projeto**, abra um contrato do projeto e, em seguida, selecione **Criar Fatura**.</span><span class="sxs-lookup"><span data-stu-id="ec110-117">On the **Project Contracts** list page, open a project contract, and then select **Create Invoice**.</span></span>

    ![Criar faturas do projeto para um contrato do projeto específico](media/CreateProjectInvoicesOneByOne.png)

    <span data-ttu-id="ec110-119">É gerada uma fatura para todas as transações referentes ao contrato do projeto selecionado que têm um estado de **Pronto para Faturar**.</span><span class="sxs-lookup"><span data-stu-id="ec110-119">An invoice is generated for all transactions for the selected project contract that have a status of **Ready to Invoice**.</span></span> <span data-ttu-id="ec110-120">Estas transações incluem o tempo, as despesas, os marcos e os itens de contrato baseados no produto.</span><span class="sxs-lookup"><span data-stu-id="ec110-120">These transactions include time, expenses, milestones, and product-based contract lines.</span></span>

<span data-ttu-id="ec110-121">Siga estes passos para criar faturas em massa.</span><span class="sxs-lookup"><span data-stu-id="ec110-121">Follow these steps to create invoices in bulk.</span></span>

1. <span data-ttu-id="ec110-122">Na página da lista de **Contratos do Projeto**, selecione um ou mais contratos do projeto para os quais tem de criar uma fatura e, em seguida, selecione **Criar Faturas do Projeto**.</span><span class="sxs-lookup"><span data-stu-id="ec110-122">On the **Project Contracts** list page, select one or more project contracts that you must create an invoice for, and then select **Create Project Invoices**.</span></span>

    ![Criar faturas do projeto em massa](media/CreateProjectInvoicesBulk.png)

    <span data-ttu-id="ec110-124">Uma mensagem de aviso informa-o de que poderá haver um atraso antes da criação das faturas.</span><span class="sxs-lookup"><span data-stu-id="ec110-124">A warning message informs you that there might be a delay before invoices are created.</span></span> <span data-ttu-id="ec110-125">O processo também é mostrado.</span><span class="sxs-lookup"><span data-stu-id="ec110-125">The process is also shown.</span></span>

2. <span data-ttu-id="ec110-126">Selecione **OK** para fechar a caixa de mensagem.</span><span class="sxs-lookup"><span data-stu-id="ec110-126">Select **OK** to close the message box.</span></span>

    <span data-ttu-id="ec110-127">É gerada uma fatura para todas as transações num item de contrato que têm um estado de **Pronto para Faturar**.</span><span class="sxs-lookup"><span data-stu-id="ec110-127">An invoice is generated for all transactions on a contract line that have a status of **Ready to Invoice**.</span></span> <span data-ttu-id="ec110-128">Estas transações incluem o tempo, as despesas, os marcos e os itens de contrato baseados no produto.</span><span class="sxs-lookup"><span data-stu-id="ec110-128">These transactions include time, expenses, milestones, and product-based contract lines.</span></span>

3. <span data-ttu-id="ec110-129">Para ver as faturas geradas, aceda a **Vendas** \> **Faturação** \> **Faturas**.</span><span class="sxs-lookup"><span data-stu-id="ec110-129">To view the invoices that are generated, go to **Sales** \> **Billing** \> **Invoices**.</span></span> <span data-ttu-id="ec110-130">Verá uma fatura para cada contrato do projeto.</span><span class="sxs-lookup"><span data-stu-id="ec110-130">You will see one invoice for each project contract.</span></span>

### <a name="set-up-automated-creation-of-project-invoices-in-psa"></a><span data-ttu-id="ec110-131">Configurar a criação automatizada de faturas do projeto no PSA</span><span class="sxs-lookup"><span data-stu-id="ec110-131">Set up automated creation of project invoices in PSA</span></span>

<span data-ttu-id="ec110-132">Siga estes passos para configurar uma fatura automatizada executada no PSA.</span><span class="sxs-lookup"><span data-stu-id="ec110-132">Follow these steps to configure an automated invoice run in PSA.</span></span>

1. <span data-ttu-id="ec110-133">Aceda a **Project Service** \> **Definições** \> **Tarefas de lote**.</span><span class="sxs-lookup"><span data-stu-id="ec110-133">Go to **Project Service** \> **Settings** \> **Batch jobs**.</span></span>
2. <span data-ttu-id="ec110-134">Crie uma tarefa de lote e atribua-lhe o nome **Criação de Faturas no PSA**.</span><span class="sxs-lookup"><span data-stu-id="ec110-134">Create a batch job, and name it **PSA Create Invoices**.</span></span> <span data-ttu-id="ec110-135">O nome da tarefa de lote tem de incluir o termo "Criar Faturas."</span><span class="sxs-lookup"><span data-stu-id="ec110-135">The name of the batch job must include the term "Create Invoices."</span></span>
3. <span data-ttu-id="ec110-136">No campo **Tipo de tarefa**, selecione **Nenhum**.</span><span class="sxs-lookup"><span data-stu-id="ec110-136">In the **Job type** field, select **None**.</span></span> <span data-ttu-id="ec110-137">Por predefinição, as opções **Frequência Diária** e **Está Ativo** estão definidas como **Sim**.</span><span class="sxs-lookup"><span data-stu-id="ec110-137">By default, the **Frequency Daily** and **Is Active** options are set to **Yes**.</span></span>
4. <span data-ttu-id="ec110-138">Selecione **Executar Fluxo de Trabalho**.</span><span class="sxs-lookup"><span data-stu-id="ec110-138">Select **Run Workflow**.</span></span> <span data-ttu-id="ec110-139">Na caixa de diálogo **Pesquisar Registo**, verá três fluxos de trabalho:</span><span class="sxs-lookup"><span data-stu-id="ec110-139">In the **Look Up Record** dialog box, you will see three workflows:</span></span>

    - <span data-ttu-id="ec110-140">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="ec110-140">ProcessRunCaller</span></span>
    - <span data-ttu-id="ec110-141">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="ec110-141">ProcessRunner</span></span>
    - <span data-ttu-id="ec110-142">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="ec110-142">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="ec110-143">Selecione **ProcessRunCaller** e, em seguida, selecione **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="ec110-143">Select **ProcessRunCaller**, and then select **Add**.</span></span>
6. <span data-ttu-id="ec110-144">Na caixa de diálogo seguinte, selecione **OK**.</span><span class="sxs-lookup"><span data-stu-id="ec110-144">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="ec110-145">Um fluxo de trabalho de **Suspensão** é seguido por um fluxo de trabalho do **Processo**.</span><span class="sxs-lookup"><span data-stu-id="ec110-145">A **Sleep** workflow is followed by a **Process** workflow.</span></span>

    <span data-ttu-id="ec110-146">Também pode selecionar **ProcessRunner** no passo 5.</span><span class="sxs-lookup"><span data-stu-id="ec110-146">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="ec110-147">Em seguida, quando selecionar **OK**, um fluxo de trabalho do **Processo** é seguido por um fluxo de trabalho de **Suspensão**.</span><span class="sxs-lookup"><span data-stu-id="ec110-147">Then, when you select **OK**, a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="ec110-148">Os fluxos de trabalho **ProcessRunCaller** e **ProcessRunner** criam faturas.</span><span class="sxs-lookup"><span data-stu-id="ec110-148">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="ec110-149">O **ProcessRunCaller** chama o **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="ec110-149">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="ec110-150">**ProcessRunner** é o fluxo de trabalho que, na realidade, cria as faturas.</span><span class="sxs-lookup"><span data-stu-id="ec110-150">**ProcessRunner** is the workflow that actually creates the invoices.</span></span> <span data-ttu-id="ec110-151">Passa por todos os itens de contrato para os quais é necessário criar faturas e cria faturas para essas linhas.</span><span class="sxs-lookup"><span data-stu-id="ec110-151">It goes through all the contract lines that invoices must be created for, and it creates invoices for those lines.</span></span> <span data-ttu-id="ec110-152">Para determinar os itens de contrato para os quais devem ser criadas faturas, a tarefa examina as datas de execução da fatura para os itens de contrato.</span><span class="sxs-lookup"><span data-stu-id="ec110-152">To determine the contract lines that invoices must be created for, the job looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="ec110-153">Se os itens de contrato que pertencem a um contrato tiverem a mesma data de execução da fatura, as transações são combinadas numa fatura que tem duas linhas de fatura.</span><span class="sxs-lookup"><span data-stu-id="ec110-153">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="ec110-154">Se não houver transações para as quais criar faturas, a tarefa ignorará a criação da fatura.</span><span class="sxs-lookup"><span data-stu-id="ec110-154">If there are no transactions to create invoices for, the job skips invoice creation.</span></span>

<span data-ttu-id="ec110-155">Depois de **ProcessRunner** ter terminado a execução, chama o **ProcessRunCaller**, fornece a hora de fim e é fechado.</span><span class="sxs-lookup"><span data-stu-id="ec110-155">After **ProcessRunner** has finished running, it calls **ProcessRunCaller**, provides the end time, and is closed.</span></span> <span data-ttu-id="ec110-156">**ProcessRunCaller** em seguida, inicia um temporizador que funciona durante 24 horas a partir da hora de fim especificada.</span><span class="sxs-lookup"><span data-stu-id="ec110-156">**ProcessRunCaller** then starts a timer that runs for 24 hours from the specified end time.</span></span> <span data-ttu-id="ec110-157">No final do temporizador, o **ProcessRunCaller** é fechado.</span><span class="sxs-lookup"><span data-stu-id="ec110-157">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="ec110-158">A tarefa de processamento em lote para criar faturas é uma tarefa recorrente.</span><span class="sxs-lookup"><span data-stu-id="ec110-158">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="ec110-159">Se este processamento em lote for executado muitas vezes, são criadas várias instâncias da tarefa e causam erros.</span><span class="sxs-lookup"><span data-stu-id="ec110-159">If this batch process is run many times, multiple instances of the job are created and cause errors.</span></span> <span data-ttu-id="ec110-160">Consequentemente, deverá iniciar o processamento em lote apenas uma vez, e só deverá reiniciá-lo se parar de ser executado.</span><span class="sxs-lookup"><span data-stu-id="ec110-160">Therefore, you should start the batch process only one time, and you should restart it only if it stops running.</span></span>
 
### <a name="edit-a-draft-psa-invoice"></a><span data-ttu-id="ec110-161">Editar um rascunho da fatura do PSA</span><span class="sxs-lookup"><span data-stu-id="ec110-161">Edit a draft PSA invoice</span></span>

<span data-ttu-id="ec110-162">Quando cria um rascunho da fatura do projeto, todas as transações de vendas não faturadas criadas quando as entradas de tempo e despesa foram aprovadas são reunidas na fatura.</span><span class="sxs-lookup"><span data-stu-id="ec110-162">When you create a draft project invoice, all unbilled sales transactions that were created when the time and expense entries were approved are pulled onto the invoice.</span></span> <span data-ttu-id="ec110-163">Pode efetuar os seguintes ajustes enquanto a fatura ainda está numa fase de rascunho:</span><span class="sxs-lookup"><span data-stu-id="ec110-163">You can make the following adjustments while the invoice is still in a draft stage:</span></span>

- <span data-ttu-id="ec110-164">Elimine ou edite os detalhes de linha de fatura.</span><span class="sxs-lookup"><span data-stu-id="ec110-164">Delete or edit invoice line details.</span></span>
- <span data-ttu-id="ec110-165">Edite e ajuste a quantidade e o tipo de faturação.</span><span class="sxs-lookup"><span data-stu-id="ec110-165">Edit and adjust the quantity and billing type.</span></span>
- <span data-ttu-id="ec110-166">Adicione diretamente o tempo, a despesa e as taxas como transações na fatura.</span><span class="sxs-lookup"><span data-stu-id="ec110-166">Directly add time, expense, and fees as transactions on the invoice.</span></span> <span data-ttu-id="ec110-167">Pode utilizar esta funcionalidade se a linha da fatura estiver mapeada para um item de contrato que permita estas classes de transação.</span><span class="sxs-lookup"><span data-stu-id="ec110-167">You can use this feature if the invoice line is mapped to a contract line that allows for these transaction classes.</span></span>

<span data-ttu-id="ec110-168">Selecione **Confirmar** para confirmar uma fatura.</span><span class="sxs-lookup"><span data-stu-id="ec110-168">Select **Confirm** to confirm an invoice.</span></span> <span data-ttu-id="ec110-169">A ação de Confirmação é uma ação unilateral.</span><span class="sxs-lookup"><span data-stu-id="ec110-169">The Confirm action is a one-way action.</span></span> <span data-ttu-id="ec110-170">Quando seleciona **Confirmar**, o sistema efetua a faturação só de leitura e cria valores reais de vendas faturadas a partir de cada detalhe de linha de fatura para cada linha de fatura.</span><span class="sxs-lookup"><span data-stu-id="ec110-170">When you select **Confirm**, the system makes the invoice read-only and creates billed sales actuals from each invoice line detail for each invoice line.</span></span> <span data-ttu-id="ec110-171">Se o detalhe de linha de fatura referenciar um valor real de vendas não faturadas, o sistema também reverte o valor real de vendas não faturadas.</span><span class="sxs-lookup"><span data-stu-id="ec110-171">If the invoice line detail references an unbilled sales actual, the system also reverses the unbilled sales actual.</span></span> <span data-ttu-id="ec110-172">(Qualquer detalhe de linha de fatura que tenha sido criado a partir de uma entrada de tempo ou despesa irá referenciar um valor real de vendas não faturadas.) Os sistemas de integração do razão geral podem utilizar esta reversão para reverter o trabalho do projeto em curso (WIP) para fins de contabilidade.</span><span class="sxs-lookup"><span data-stu-id="ec110-172">(Any invoice line detail that was created from a time or expense entry will reference an unbilled sales actual.) General ledger integration systems can use this reversal to reverse project work in progress (WIP) for accounting purposes.</span></span>

### <a name="correct-a-confirmed-psa-invoice"></a><span data-ttu-id="ec110-173">Corrigir uma fatura do PSA confirmada</span><span class="sxs-lookup"><span data-stu-id="ec110-173">Correct a confirmed PSA invoice</span></span>

<span data-ttu-id="ec110-174">As faturas do PSA confirmadas podem ser editadas (corrigidas).</span><span class="sxs-lookup"><span data-stu-id="ec110-174">Confirmed PSA invoices can be edited (corrected).</span></span> <span data-ttu-id="ec110-175">Quando corrige uma fatura confirmada, uma nova fatura corretiva de rascunho é criada.</span><span class="sxs-lookup"><span data-stu-id="ec110-175">When you correct a confirmed invoice, a new draft corrective invoice is created.</span></span> <span data-ttu-id="ec110-176">Dado que a pressuposição é que pretende reverter todas as transações e quantidades da fatura original, esta fatura corretiva inclui todas as transações da fatura original e todas as quantidades são 0 (zero).</span><span class="sxs-lookup"><span data-stu-id="ec110-176">Because the assumption is that you want to reverse all the transactions and quantities from the original invoice, this corrective invoice includes all the transactions from the original invoice, and all the quantities on it are 0 (zero).</span></span>

<span data-ttu-id="ec110-177">Se alguma transação não necessitar de correção, pode removê-la da fatura corretiva de rascunho.</span><span class="sxs-lookup"><span data-stu-id="ec110-177">If any transactions don't require correction, you can remove them from the draft corrective invoice.</span></span> <span data-ttu-id="ec110-178">Se pretender reverter ou devolver apenas uma quantidade parcial, pode editar o campo **Quantidade** no detalhe de linha.</span><span class="sxs-lookup"><span data-stu-id="ec110-178">If you want to reverse or return only a partial quantity, you can edit the **Quantity** field on the line detail.</span></span> <span data-ttu-id="ec110-179">Se abrir o detalhe de linha de fatura, poderá ver a quantidade original da fatura.</span><span class="sxs-lookup"><span data-stu-id="ec110-179">If you open the invoice line detail, you can see the original invoice quantity.</span></span> <span data-ttu-id="ec110-180">Em seguida, pode editar a quantidade da fatura atual para que seja inferior ou superior à quantidade original da fatura.</span><span class="sxs-lookup"><span data-stu-id="ec110-180">You can then edit the current invoice quantity so that it's less than or more than the original invoice quantity.</span></span>

<span data-ttu-id="ec110-181">Quando confirma uma fatura corretiva, o valor real de vendas faturadas originais é revertido e é criado um novo valor real de vendas faturadas.</span><span class="sxs-lookup"><span data-stu-id="ec110-181">When you confirm a corrective invoice, the original billed sales actual is reversed, and a new billed sales actual is created.</span></span> <span data-ttu-id="ec110-182">Se a quantidade tiver sido reduzida, a diferença causará a criação de um novo valor real de vendas não faturadas.</span><span class="sxs-lookup"><span data-stu-id="ec110-182">If the quantity was reduced, the difference will cause a new unbilled sales actual to be created too.</span></span> <span data-ttu-id="ec110-183">Por exemplo, se as vendas faturadas originais eram de oito horas e o detalhe de linha de fatura corretiva tiver uma quantidade reduzida de seis horas, o PSA reverte a linha de vendas faturadas originais e cria dois novos valores reais:</span><span class="sxs-lookup"><span data-stu-id="ec110-183">For example, if the original billed sales was for eight hours, and the corrective invoice line detail has a reduced quantity of six hours, PSA reverses the original billed sales line and creates two new actuals:</span></span>

- <span data-ttu-id="ec110-184">Um valor real de vendas faturadas durante seis horas.</span><span class="sxs-lookup"><span data-stu-id="ec110-184">A billed sales actual for six hours.</span></span>
- <span data-ttu-id="ec110-185">Uma valor real de vendas não faturadas para as duas horas restantes.</span><span class="sxs-lookup"><span data-stu-id="ec110-185">An unbilled sales actual for the remaining two hours.</span></span> <span data-ttu-id="ec110-186">Esta transação pode ser faturada mais tarde ou marcada como não faturável, dependendo das negociações com o cliente.</span><span class="sxs-lookup"><span data-stu-id="ec110-186">This transaction can either be billed later or marked as non-chargeable, depending on the negotiations with the customer.</span></span>
