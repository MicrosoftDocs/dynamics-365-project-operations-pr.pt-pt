---
title: Integração de gestão de despesas
description: Este tópico fornece informações sobre a integração de relatório de despesa no Project Operations utilizando escrita dupla.
author: sigitac
ms.date: 04/28/2021
ms.topic: article
ms.prod: ''
ms.reviewer: kfend
ms.author: sigitac
ms.openlocfilehash: 7fff69f062bf09fe7ceca61d951b535d2e010bfd
ms.sourcegitcommit: 40f68387f594180af64a5e5c748b6efa188bd300
ms.translationtype: HT
ms.contentlocale: pt-PT
ms.lasthandoff: 05/10/2021
ms.locfileid: "6000000"
---
# <a name="expense-management-integration"></a><span data-ttu-id="c9e72-103">Integração de gestão de despesas</span><span class="sxs-lookup"><span data-stu-id="c9e72-103">Expense management integration</span></span>

<span data-ttu-id="c9e72-104">_**Aplica-se A:** Project Operations para cenários baseados em recursos/não armazenados_</span><span class="sxs-lookup"><span data-stu-id="c9e72-104">_**Applies To:** Project Operations for resource/non-stocked based scenarios_</span></span>

<span data-ttu-id="c9e72-105">Este tópico fornece informações sobre a integração de relatórios de despesa no Project Operations [Implementação de todas as despesas](../expense/expense-overview.md) utilizando escrita dupla.</span><span class="sxs-lookup"><span data-stu-id="c9e72-105">This topic provides information about expense reports integration in Project Operations [full expense deployment](../expense/expense-overview.md) using dual-write.</span></span>

## <a name="expense-categories"></a><span data-ttu-id="c9e72-106">Categorias de despesas</span><span class="sxs-lookup"><span data-stu-id="c9e72-106">Expense categories</span></span>

<span data-ttu-id="c9e72-107">Numa implementação total de despesas, as categorias de despesas são criadas e mantidas em aplicações Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="c9e72-107">In a full expense deployment, expense categories are created and maintained in Finance and Operations apps.</span></span> <span data-ttu-id="c9e72-108">Para criar uma nova categoria de despesas, complete os seguintes passos:</span><span class="sxs-lookup"><span data-stu-id="c9e72-108">To create a new expense category, complete the following steps:</span></span>

1. <span data-ttu-id="c9e72-109">Em Microsoft Dataverse, crie uma categoria de **Transação**.</span><span class="sxs-lookup"><span data-stu-id="c9e72-109">In Microsoft Dataverse, create a **Transaction** category.</span></span> <span data-ttu-id="c9e72-110">A integração de escritas« dupla irá sincronizar esta categoria de transação para aplicações Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="c9e72-110">Dual-write integration will synchronize this transaction category to Finance and Operations apps.</span></span> <span data-ttu-id="c9e72-111">Para obter mais informações, consulte [Configurar categorias de projetos](/dynamics365/project-operations/project-accounting/configure-project-categories) e [Configuração do Project Operations e integração de dados de configuração](resource-dual-write-setup-integration.md).</span><span class="sxs-lookup"><span data-stu-id="c9e72-111">For more information, see [Configure project categories](/dynamics365/project-operations/project-accounting/configure-project-categories) and [Project Operations setup and configuration data integration](resource-dual-write-setup-integration.md).</span></span> <span data-ttu-id="c9e72-112">Como resultado desta integração, o sistema cria quatro registos de categorias partilhadas em aplicações Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="c9e72-112">As a result of this integration, the system creates four shared category records in Finance and Operations apps.</span></span>
2. <span data-ttu-id="c9e72-113">Em Finanças, vá à **Gestão de despesas** > **Configuração** > **Categorias partilhadas** e selecione uma categoria partilhada com uma classe de transação de **Despesas**.</span><span class="sxs-lookup"><span data-stu-id="c9e72-113">In Finance, go to **Expense management** > **Setup** > **Shared categories** and select a shared category with an **Expense** transaction class.</span></span> <span data-ttu-id="c9e72-114">Defina o parâmetro **Pode ser usado em Despesa** para **Verdadeiro** e defina o tipo de despesa a utilizar.</span><span class="sxs-lookup"><span data-stu-id="c9e72-114">Set the **Can be used in Expense** parameter to **True** and define the expense type to use.</span></span>
3. <span data-ttu-id="c9e72-115">Utilizando este registo de categoria partilhada, crie uma nova categoria de despesas indo para **Gestão de despesa** > **Configuração** > **Categorias de despesa** e selecionando **Novo**.</span><span class="sxs-lookup"><span data-stu-id="c9e72-115">Using this shared category record, create a new expense category by going to **Expense management** > **Setup** > **Expense categories** and selecting **New**.</span></span> <span data-ttu-id="c9e72-116">Quando o registo é guardado, a dupla escrita utiliza o mapa de tabela, **Entidade de exportação de despesas de integração do Project Operations (msdyn\_expensecategories)** para sincronizar este registo para Dataverse.</span><span class="sxs-lookup"><span data-stu-id="c9e72-116">When the record is saved, dual-write uses the table map, **Project Operations integration project expense categories export entity (msdyn\_expensecategories)** to synchronize this record to Dataverse.</span></span>

  ![Integração de categorias de despesas](./media/DW6ExpenseCategories.png)

<span data-ttu-id="c9e72-118">As categorias de despesas em aplicações Finance and Operations são específicas da empresa ou da entidade legal.</span><span class="sxs-lookup"><span data-stu-id="c9e72-118">Expense categories in Finance and Operations apps are company- or legal entity-specific.</span></span> <span data-ttu-id="c9e72-119">Existem registos separados e correspondentes de entidades jurídicas específicas em Dataverse.</span><span class="sxs-lookup"><span data-stu-id="c9e72-119">There are separate, corresponding legal entity-specific records in Dataverse.</span></span> <span data-ttu-id="c9e72-120">Quando um gestor de projetos estima as despesas, não podem selecionar categorias de despesas que foram criadas para um projeto que é propriedade de uma empresa diferente da empresa proprietária do projeto em que estão a trabalhar.</span><span class="sxs-lookup"><span data-stu-id="c9e72-120">When a project manager estimates expenses, they can’t select expense categories that were created for a project that is owned by a different company than the company that owns the project they are working on.</span></span> 

## <a name="expense-reports"></a><span data-ttu-id="c9e72-121">Relatórios de despesas</span><span class="sxs-lookup"><span data-stu-id="c9e72-121">Expense reports</span></span>

<span data-ttu-id="c9e72-122">Os relatórios de despesas são criados e aprovados em aplicações Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="c9e72-122">Expense reports are created and approved in Finance and Operations apps.</span></span> <span data-ttu-id="c9e72-123">Para obter mais informações, consulte [Criar e processar relatórios de despesas em Dynamics 365 Project Operations](/learn/modules/create-process-expense-reports/).</span><span class="sxs-lookup"><span data-stu-id="c9e72-123">For more information, see [Create and process expense reports in Dynamics 365 Project Operations](/learn/modules/create-process-expense-reports/).</span></span> <span data-ttu-id="c9e72-124">Depois do relatório de despesas ser aprovado pelo diretor do projeto, é publicado no livro razão.</span><span class="sxs-lookup"><span data-stu-id="c9e72-124">After the expense report is approved by the Project manager, it's posted to the general ledger.</span></span> <span data-ttu-id="c9e72-125">No Project Operations, as linhas de relatório de despesas relacionadas com o projeto são publicadas utilizando regras especiais de publicação:</span><span class="sxs-lookup"><span data-stu-id="c9e72-125">In Project Operations, project-related expense report lines are posted using special posting rules:</span></span>

  - <span data-ttu-id="c9e72-126">O custo relacionado com o projeto (incluindo o imposto não recuperável) não é imediatamente registado na conta de custos do projeto em geral, mas é registado na conta de integração de despesas.</span><span class="sxs-lookup"><span data-stu-id="c9e72-126">Project-related cost (including non-recoverable tax) is not immediately posted to project cost account in general ledger, but instead is posted to expense integration account.</span></span> <span data-ttu-id="c9e72-127">Esta conta é configurada no separador **Gestão de projetos e gestão contabilística** > **Configuração** > **gestão de projetos e parâmetros de gestão contabilística**, **Project Operations no Dynamics 365 Customer engagement**.</span><span class="sxs-lookup"><span data-stu-id="c9e72-127">This account is configured in **Project management and accounting** > **Setup** > **Project management and accounting parameters**, **Project Operations on Dynamics 365 Customer engagement** tab.</span></span>
  - <span data-ttu-id="c9e72-128">A dupla escrita sincroniza para Dataverse utilizando o mapa da tabela **Entidade de exportação de despesas de projeto de integração do Project Operations (msdyn\_expenses)**.</span><span class="sxs-lookup"><span data-stu-id="c9e72-128">Dual-write synchronizes to Dataverse using **Project Operations integration project expenses export entity (msdyn\_expenses)** table map.</span></span>
  - <span data-ttu-id="c9e72-129">O sub-livro razão de impostos, o sub-livro razão de fornecedores e outros destacamentos financeiros são registados conforme aplicável no momento da publicação do relatório de despesas.</span><span class="sxs-lookup"><span data-stu-id="c9e72-129">Tax subledger, vendor subledger, and other financial postings are recorded as applicable at the time of expense report posting.</span></span>

  ![Integração de relatórios de despesas](./media/DW6ExpenseReports.png)

<span data-ttu-id="c9e72-131">Quando um registo é escrito na entidade **Despesa** em Dataverse, o sistema aciona o processo de aprovação automatizado do registo.</span><span class="sxs-lookup"><span data-stu-id="c9e72-131">When a record is written to the **Expense** entity in Dataverse, the system triggers the automated approval process of the record.</span></span> <span data-ttu-id="c9e72-132">Se necessário, o estado do processo de aprovação automatizado pode ser revisto em Dataverse indo para **Definições avançadas** > **Sistema** > **Trabalhos do sistema**.</span><span class="sxs-lookup"><span data-stu-id="c9e72-132">If needed, the automated approval process status can be reviewed in Dataverse by going to **Advanced settings** > **System** > **System jobs**.</span></span> <span data-ttu-id="c9e72-133">Após a aprovação estar concluída, os registos de classe de transações de despesas são criados na entidade **Valores reais**.</span><span class="sxs-lookup"><span data-stu-id="c9e72-133">After approval is complete, expense transaction class records are created in the **Actuals** entity.</span></span>

<span data-ttu-id="c9e72-134">Os valores reais relacionados com as despesas são então processados utilizando o mapa de tabela de dupla escrita **Valores reais de integração do Project Operations (msdyn\_actuals)**.</span><span class="sxs-lookup"><span data-stu-id="c9e72-134">Expense related actuals are then processed using the dual-write table map **Project Operations integration actuals (msdyn\_actuals)**.</span></span> <span data-ttu-id="c9e72-135">Para mais informações, consulte [Estimativas e valores reais](resource-dual-write-estimates-actuals.md).</span><span class="sxs-lookup"><span data-stu-id="c9e72-135">For more information, see [Project estimates and actuals](resource-dual-write-estimates-actuals.md).</span></span>

<span data-ttu-id="c9e72-136">O processo periódico, **Importar de teste** cria linhas de diários relacionados com o relatório de despesas no diário de integração do Project Operations.</span><span class="sxs-lookup"><span data-stu-id="c9e72-136">The periodic process, **Import from staging** creates Expense report-related journal lines in the Project Operations Integration journal.</span></span> <span data-ttu-id="c9e72-137">A conta offset é predefinida para a conta de integração de despesas.</span><span class="sxs-lookup"><span data-stu-id="c9e72-137">The offset account defaults to the expense integration account.</span></span> <span data-ttu-id="c9e72-138">O Diário de Integração de destacamento limpa o saldo da conta para a transação de despesas e transfere o valor da despesa para a conta de custos do projeto.</span><span class="sxs-lookup"><span data-stu-id="c9e72-138">The Posting integration journal clears the account balance for the expense transaction and moves the expense amount to the project cost account.</span></span> <span data-ttu-id="c9e72-139">O sistema também cria transações de sub-livros razão de projetos para efeitos de faturação a jusante e reconhecimento de receitas.</span><span class="sxs-lookup"><span data-stu-id="c9e72-139">The system also creates project subledger transactions for downstream invoicing and revenue recognition purposes.</span></span>
